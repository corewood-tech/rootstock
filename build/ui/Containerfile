FROM node:22-bookworm-slim AS builder

WORKDIR /app

ARG VITE_BASE_PATH
ENV VITE_BASE_PATH=${VITE_BASE_PATH:-/app}

COPY ui/package*.json ./
RUN npm install

COPY ui/ .
RUN npm run build

FROM caddy:2-alpine
COPY --from=builder /app/.svelte-build /srv
